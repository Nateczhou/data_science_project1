---
title: "Project1"
output: html_notebook
---

```{r}
h1b <- read.csv('h1b_datahubexport_2009-2019.csv')
str(h1b)
#h1b$State
```

1. How have U.S. H1b visa acceptances and denials changed over the course of 2015-2019?
  1a) How does industry effect H1b visas from the time spanning 2015-2019?
  1b) How does US location effect H1b visas from 2015-2019?
  1c) How does year affect H1b visa acceptance from 2015-2019?
  1d) How has the change in presidency from 2015-2019 affected H1b visa acceptances and denials?
  
IV: H1b initial approvals
    H1b iniitial denials
    H1b continuing approvals
    H1b continuing denials

DV: type of industry
    U.S. location
    year/time (total 10 yrs and 2015-2019)
    U.S. presidency
    
    
```{r}
library(dplyr)
library(tidyr)
```
    
```{r}
#nas <- na.omit(h1b$State)
#nas
new <- h1b %>% drop_na(State) %>% group_by(State) %>%
  summarise(totalinitialapp = sum(Initial.Approvals, na.rm = T),
            totalinitialden = sum(Initial.Denials, na.rm = T))

test <- h1b %>% drop_na(State) %>% group_by(State) %>%
  summarise(totalinitialapp = sum(Initial.Approvals, na.rm = T))
```

```{r}
library(ggplot2)
#install.packages("maps")
library(maps)
#install.packages("openintro")
library(openintro)
library(tidyverse)
```

```{r}
usstate <- map_data("state")
copy <- map_data("state")
colnames(usstate)[colnames(usstate)=="region"] <- "State_name"
usstate <- usstate %>% mutate(State = state2abbr(State_name))

test$State <- as.character(test$State)
state_app <- inner_join(usstate, test, by = "State")
head(state_app)
```

```{r}
state_approval <- state_app %>% select(long, lat, group, order, State, totalinitialapp, State_name)
head(state_approval)
```

```{r}
head(copy)
uss <- ggplot(data = copy) +
  geom_polygon(aes(x = long, y = lat, fill = region, group = group), color = "white") +
  coord_fixed(1.3) +
  guides(fill = FALSE)

uss
```



```{r}
us_base <- ggplot(data = state_approval, mapping = aes(x = long, y = lat, group = group)) +
  coord_fixed(1.3) +
  geom_polygon(color = "black", fill = "gray")

us_base + theme_nothing()

#us_base + theme_nothing() +
#  geom_polygon(data = state_approval, fill = NA, group = group, color = "white") +
#  geom_polygon(color = "black", fill = NA)

ditch_the_axes <- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  axis.title = element_blank()
  )

elbow_rooml <- us_base + geom_polygon(data = state_approval, aes(fill = totalinitialapp), color = "white") +
  geom_polygon(color = "black", fill = NA) +
  theme_bw() +
  ditch_the_axes

```

```{r}
<<<<<<< Updated upstream
elbow_rooml 

#p <- ggplot(data = usstate) +
#  geom_polygon(aes(x = long, y = lat, fill = NA, group = group), color = "white") + 
#  coord_fixed(1.3) +
#  guides(fill=FALSE) 

#p + geom_polygon(aes(x = long, y = lat, fill = totalinitialapp, group = group))
=======
eb1 <- elbow_rooml + scale_fill_gradient(trans = "log10")
eb1

eb2 <- elbow_rooml + scale_fill_gradientn(colours = rev(rainbow(7)), breaks = c(1000, 10000, 100000), trans = "log10")
eb2
>>>>>>> Stashed changes
```

