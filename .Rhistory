theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.bumpup", "last.bumpup"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.bumpup", "last.bumpup"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.bumpup", "last.bumpup"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.bumpup", "last.bumpup"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.bumpup", "last.bumpup"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(axis.text.x = element_text(angle = 45, vjust = 1)) +
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics),size = 1) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks = seq(50, 100, 5)))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks = seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics),size = 1) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("cdenperc.png", width=12, height=9)
