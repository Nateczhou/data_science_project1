ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics), method = list(dl.combine("first.qp", "last.qp"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics)) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=2) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics),size = 1) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("cdenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks = seq(50, 100, 5)))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks = seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1)+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))
ggsave("idenperc.png", width=12, height=9)
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("idenperc.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics),size = 1) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("cdenperc.png", width=12, height=9)
library(dplyr)
h1b <- read.csv('h1b_datahubexport_2009-2019.csv')
str(h1b)
library(ggplot2)
h1b$naics = as.factor(h1b$NAICS)
# use group by to combine same industry together to calculate the total initial application amount.
initial <- h1b %>% group_by(naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T), #shows total number of initail approvals
totaliniden = sum(Initial.Denials, na.rm = T), # shows total number of initial denials
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T), # shows total number of initial application
iaccptperc = (totaliniaccpt/totalinitial)*100, round(iaccptperc, digits = 2), # percentage of initial approval rate
idenperc = (totaliniden/totalinitial)*100, round(idenperc, digits = 2)) #percentage of initial denial rate
ggplot(initial, aes(x = naics, y = iaccptperc, color = naics, fill = naics)) + # percentage of initial approvals rate and color by industry code
geom_bar(stat ="identity") +
xlab("NAICS CODE") +
ylab("Total Initial Approvals Percentage")
ggplot(initial, aes(x = naics, y = idenperc, color = naics, , fill = naics)) + # percentage of initial denials rate and color by industry code
geom_bar(stat ="identity") +
xlab("NAICS CODE") +
ylab("Total Initial Denials Percentage")
# use group by to combine same industry together to calculate the total continuing application amount.
continuing <- h1b %>% group_by(naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuing, aes(x = naics, y = caccptperc, color = naics, fill = naics)) + geom_bar(stat ="identity") + xlab("NAICS CODE") + ylab("Total Continuing Approvals Percentage")
ggplot(continuing, aes(x = naics, y = cdenperc, color = naics, fill = naics)) + geom_bar(stat ="identity") + xlab("NAICS CODE") + ylab("Total Continuing Denials Percentage")
#install.packages("directlabels")
library(directlabels)
initialbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T),
totaliniden = sum(Initial.Denials, na.rm = T),
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T),
iaccptperc = (totaliniaccpt/totalinitial)*100,
idenperc = (totaliniden/totalinitial)*100)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=iaccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +   # create the line by nacis code
ggtitle("Line Plot of Industry and  Initial Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +  # for visualization purpose, we set up the point for each year so people can directly see the rate change of industry by year
theme(plot.title = element_text(hjust = 0.5)) +  # since we change the size of the figer, we need to relocate the fig name to center
xlab("Year")+ ylab("Percentage(%)")+  # rename x and y axis names
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+  #set up label for each line
scale_x_continuous(breaks=seq(2009, 2019, 1))+   # changing the scale for both x and y axis
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("iaccptperc.png", width=12, height=9)
ggplot(initialbyyear, aes(x=Fiscal.Year, y=idenperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and  Initial Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("idenperc.png", width=12, height=9)
#use group by to combine same industry together to calculate the total continuing application amount.
continuingbyyear <- h1b %>% group_by(Fiscal.Year, naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=caccptperc)) +
geom_line(aes(color=naics, group=naics), size = 1) +
ggtitle("Line Plot of Industry and Continuing Approvals Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("caccptperc.png", width=12, height=9)
ggplot(continuingbyyear, aes(x=Fiscal.Year, y=cdenperc)) +
geom_line(aes(color=naics, group=naics),size = 1) +
ggtitle("Line Plot of Industry and Continuing Denials Percentage by Year")+
geom_point(aes(color=naics), size=3) +
theme(plot.title = element_text(hjust = 0.5)) +
xlab("Year")+ ylab("Percentage(%)")+
geom_dl(aes(label = naics, color = naics), method = list(dl.combine("first.polygons", "last.polygons"), cex = 1))+
scale_x_continuous(breaks=seq(2009, 2019, 1))+
scale_y_continuous(breaks=seq(50, 100, 5))
ggsave("cdenperc.png", width=12, height=9)
write.csv(initialbyyear, file = "initialbyyear.csv")
write.csv(continuingbyyear, file = "continuingbyyear.csv")
View(initialbyyear)
library(ggplot2)
h1b$naics = as.factor(h1b$NAICS)
# use group by to combine same industry together to calculate the total initial application amount.
initial <- h1b %>% group_by(naics) %>% summarize( totaliniaccpt = sum(Initial.Approvals, na.rm = T), #shows total number of initail approvals
totaliniden = sum(Initial.Denials, na.rm = T), # shows total number of initial denials
totalinitial = sum(Initial.Approvals,na.rm = T)+sum(Initial.Denials,na.rm = T), # shows total number of initial application
iaccptperc = (totaliniaccpt/totalinitial)*100, round(iaccptperc, digits = 2), # percentage of initial approval rate
idenperc = (totaliniden/totalinitial)*100, round(idenperc, digits = 2)) #percentage of initial denial rate
ggplot(initial, aes(x = naics, y = iaccptperc, color = naics, fill = naics)) + # percentage of initial approvals rate and color by industry code
geom_bar(stat ="identity") +
xlab("NAICS CODE") +
ylab("Total Initial Approvals Percentage")
ggsave("Total Initial Approvals Percentage.png", width=12, height=9)
ggplot(initial, aes(x = naics, y = idenperc, color = naics, , fill = naics)) + # percentage of initial denials rate and color by industry code
geom_bar(stat ="identity") +
xlab("NAICS CODE") +
ylab("Total Initial Denials Percentage")
ggsave("Total Denial Approvals Percentage.png", width=12, height=9)
# use group by to combine same industry together to calculate the total continuing application amount.
continuing <- h1b %>% group_by(naics) %>% summarize( totalconaccpt = sum(Continuing.Approvals, na.rm = T),
totalconden = sum(Continuing.Denials, na.rm = T),
totalcontinue = sum(Continuing.Approvals,na.rm = T)+sum(Continuing.Denials,na.rm = T),
caccptperc = (totalconaccpt/totalcontinue) * 100,
cdenperc = ( totalconden /totalcontinue) * 100 )
ggplot(continuing, aes(x = naics, y = caccptperc, color = naics, fill = naics)) + geom_bar(stat ="identity") + xlab("NAICS CODE") + ylab("Total Continuing Approvals Percentage")
ggsave("Total Continuing Approvals Percentage.png", width=12, height=9)
ggplot(continuing, aes(x = naics, y = cdenperc, color = naics, fill = naics)) + geom_bar(stat ="identity") + xlab("NAICS CODE") + ylab("Total Continuing Denials Percentage")
ggsave("Total Continuing DenialsPercentage.png", width=12, height=9)
